<!doctype html>
<html>
  <head>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta charset="utf-8">
    <title>Pike Reference Manual - SSL.context</title>
    <!-- 220-->
    <link rel='stylesheet' href='../../../style.css'>
    <script src='../../../site.js'></script>
    <script src='../../../pike_version.js'></script>
    <script src='../../../timestamp.js'></script>
    <style type='text/css'>
svg line { stroke:#343434; stroke-width:2; }
svg text { fill:#343434; }
svg a { fill:#0768b2; text-decoration: underline; }
</style>

  </head>
  <body>
    <header>
      <div class="header">
        <div id="version"><strong data-id="version"></strong></div>
        <div id="burger">&#9776;</div><!-- Hamburger icon -->
        <h1>
          <a href="http://pike.lysator.liu.se/" class="logo">
            <span>Pike programming language</span>
          </a>
        </h1>
      </div>
    </header>
    <div id="page">
      <div class="navbar">
        <nav>
          <div class="inner" id="navbar">
            <a href='../../../index.html'><b class='top head'>Top</b></a>
<a href='../../../ex/7.8_3A_3A.html'><b class='head'>7.8::</b></a>
<a href='../../../ex/7.8_3A_3A/SSL.html'><b class='head'>SSL</b></a>
<b class='selected head'>SSL.context</b>
<script></script>
<noscript>
<div class='sidebar'>
<a href='../../../ex/7.8_3A_3A/SSL/context/index.html'><b>Symbol index</b></a><br />
</div>
</noscript>

          </div>
        </nav>
      </div>
      <div class="content">
        <div class="navbox">
          <nav>
            <div class="sidebar">
              <a href="../../../ex/7.8_3A_3A/SSL/connection/to_write.html" class="prev"><span>&#10148;</span> SSL.connection()-&gt;to_write()</a>
              <a href="../../../ex/7.8_3A_3A/SSL/context/advertise_protocols.html" class="next">SSL.context()-&gt;advertise_protocols() <span>&#10148;</span></a>
            </div>
          </nav>
        </div>
        <div class="contentbox">
          <article>
            <h1>Class SSL.context</h1>
            
<dt class='head--doc'>Inheritance graph</dt>
<div class='inheritance-graph'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xml:space='preserve' width='100%' height='45px'>
<text x='0' y='20'><tspan style='font-family:monospace; font-weight:bold;'>7.8::SSL.context</tspan></text>
<line x1='5' y1='25' x2='5' y2='36' />
<line x1='4' y1='35' x2='35' y2='35' />
<text x='40' y='40'><a class='ms reference' xlink:href='../../7.8_3A_3A/SSL/sslport.html'>7.8::SSL.sslport</a></text>
</svg></div>
<dl class='group--doc'>
<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Keeps the state that is shared by all SSL-connections for
 one server (or one port). It includes policy configuration, a server
 certificate, the server's private key(s), etc. It also includes the
 session cache.</p>
</dd></dl>

<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>advertised_protocols</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>string</code>) SSL.context.<b><span class='variable'>advertised_protocols</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>List of advertised protocols using using TLS next protocol negotiation.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>auth_level</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>auth_level</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Policy for client authentication. One of <a class='ms reference' href='../../predef_3A_3A/SSL/Constants.html'>SSL.Constants.AUTHLEVEL_none</a>,
 <a class='ms reference' href='../../predef_3A_3A/SSL/Constants.html'>SSL.Constants.AUTHLEVEL_ask</a> and <a class='ms reference' href='../../predef_3A_3A/SSL/Constants.html'>SSL.Constants.AUTHLEVEL_require</a>.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>certificates</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>string</code>) SSL.context.<b><span class='variable'>certificates</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>The server's certificate, or a chain of X509.v3 certificates, with the
 server's certificate first and root certificate last.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>client_certificate_selector</b></span>
</dt>
<dd><p><code><code class='datatype'>function</code>(<code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>.context</a></code>, <code class='datatype'>array</code>(<code class='datatype'>int</code>), <code class='datatype'>array</code>(<code class='datatype'>string</code>):<code class='datatype'>array</code>(<code class='datatype'>string</code>)) SSL.context.<b><span class='variable'>client_certificate_selector</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>A function which will select an acceptable client certificate for
 presentation to a remote server. This function will receive
 the SSL context, an array of acceptable certificate types,
 and a list of DNs of acceptable certificate authorities. This function
 should return an array of strings containing a certificate chain,
 with the client certificate first, (and the root certificate last, if
 applicable.)</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>client_certificates</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>array</code>(<code class='datatype'>string</code>)) SSL.context.<b><span class='variable'>client_certificates</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>An array of certificate chains a client may present to a server
 when client certificate authentication is requested.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>client_rsa</b></span>
</dt>
<dd><p><code><code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/Crypto/RSA.html'>Crypto.RSA</a></code> SSL.context.<b><span class='variable'>client_rsa</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>The client's private key (used with client certificate authentication)</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>client_server_names</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>string</code>) SSL.context.<b><span class='variable'>client_server_names</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Host names to send to the server when using the Server Name extension.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>client_use_sni</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>client_use_sni</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Should an SSL client include the Server Name extension?</p>
<p> If so, then client_server_names should specify the values to
 send.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>dh_params</b></span>
</dt>
<dd><p><code><code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/SSL/Cipher/DHParameters.html'>.Cipher.DHParameters</a></code> SSL.context.<b><span class='variable'>dh_params</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Parameters for dh keyexchange.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>dsa</b></span>
</dt>
<dd><p><code><code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/Crypto/DSA.html'>Crypto.DSA</a></code> SSL.context.<b><span class='variable'>dsa</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Servers default dsa key.</p>
</dd>
<dt class='head--doc'>Note</dt>
<dd class='body--doc'><p>If SNI (Server Name Indication) is used and multiple keys
   are available, this key will not be used, instead the appropriate
   SNI key will be used (the default implementation stores these in
   <a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>sni_keys</a>.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>long_rsa</b></span><br>
<span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>short_rsa</b></span><br>
</dt>
<dd><p><code><code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/Crypto/RSA.html'>Crypto.RSA</a></code> SSL.context.<b><span class='variable'>long_rsa</span></b></code><br>
<code><code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/Crypto/RSA.html'>Crypto.RSA</a></code> SSL.context.<b><span class='variable'>short_rsa</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Temporary, non-certified, private keys, used with a
 server_key_exchange message. The rules are as follows:</p>
<p> If the long_rsa is not zero its public part will be sent. If it is
 zero and short_rsa is set, its public part will be sent instead.
 If they are both zero, no server_key_exchange message is sent.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>max_sessions</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>max_sessions</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Maximum number of sessions to keep in the cache.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>preferred_auth_methods</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>int</code>) SSL.context.<b><span class='variable'>preferred_auth_methods</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>For client authentication. Used only if auth_level is AUTH_ask or
 AUTH_require.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>preferred_compressors</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>int</code>) SSL.context.<b><span class='variable'>preferred_compressors</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Always ({ COMPRESSION_null })</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>preferred_suites</b></span>
</dt>
<dd><p><code><code class='datatype'>array</code>(<code class='datatype'>int</code>) SSL.context.<b><span class='variable'>preferred_suites</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Cipher suites we want to support, in order of preference, best first.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>random</b></span>
</dt>
<dd><p><code><code class='datatype'>function</code>(<code class='datatype'>int</code>:<code class='datatype'>string</code>) SSL.context.<b><span class='variable'>random</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Used to generate random cookies for the hello-message. If we use
 the RSA keyexchange method, and this is a server, this random
 number generator is not used for generating the master_secret.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>require_trust</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>require_trust</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>When set, require the chain to be known, even if the root is self signed.</p>
<p> Note that if set, and certificates are set to be verified, trusted issuers must be
 provided, or no connections will be accepted.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>rsa</b></span>
</dt>
<dd><p><code><code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/Crypto/RSA.html'>Crypto.RSA</a></code> SSL.context.<b><span class='variable'>rsa</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>The server's default private key</p>
</dd>
<dt class='head--doc'>Note</dt>
<dd class='body--doc'><p>If SNI (Server Name Indication) is used and multiple keys
   are available, this key will not be used, instead the appropriate
   SNI key will be used (the default implementation stores these in
   <a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>sni_keys</a>.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>select_server_certificate_func</b></span>
</dt>
<dd><p><code><code class='datatype'>function</code>(<code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>.context</a></code>, <code class='datatype'>array</code>(<code class='datatype'>string</code>):<code class='datatype'>array</code>(<code class='datatype'>string</code>)) SSL.context.<b><span class='variable'>select_server_certificate_func</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>A function which will select an acceptable server certificate for
 presentation to a client. This function will receive
 the SSL context, and an array of server names, if provided by the
 client. This function should return an array of strings containing a
 certificate chain, with the client certificate first, (and the root
 certificate last, if applicable.)</p>
<p> The default implementation will select a certificate chain for a given server
 based on values contained in <a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>sni_certificates</a>.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>select_server_key_func</b></span>
</dt>
<dd><p><code><code class='datatype'>function</code>(<code class='object resolved'><a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>.context</a></code>, <code class='datatype'>array</code>(<code class='datatype'>string</code>):<code class='datatype'>object</code>) SSL.context.<b><span class='variable'>select_server_key_func</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>A function which will select an acceptable server key for
 presentation to a client. This function will receive
 the SSL context, and an array of server names, if provided by the
 client. This function should return an object matching the certificate
 for the server hostname.</p>
<p> The default implementation will select the key for a given server
 based on values contained in <a class='ms reference' href='../../7.8_3A_3A/SSL/context.html'>sni_keys</a>.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>session_lifetime</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>session_lifetime</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Sessions are removed from the cache when they are older than this
 limit (in seconds). Sessions are also removed from the cache if a
 connection using the session dies unexpectedly.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>sni_certificates</b></span>
</dt>
<dd><p><code><code class='datatype'>mapping</code>(<code class='datatype'>string</code>:<code class='datatype'>array</code>(<code class='datatype'>string</code>)) SSL.context.<b><span class='variable'>sni_certificates</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>A mapping containing certificate chains for use by SNI (Server Name
 Indication). Each entry should consist of a key indicating the server
 hostname and the value containing the certificate chain for that hostname.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>sni_keys</b></span>
</dt>
<dd><p><code><code class='datatype'>mapping</code>(<code class='datatype'>string</code>:<code class='datatype'>object</code>) SSL.context.<b><span class='variable'>sni_keys</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>A mapping containing private keys for use by SNI (Server Name
 Indication). Each entry should consist of a key indicating the server
 hostname and the value containing the private key object for that hostname.</p>
</dd>
<dt class='head--doc'>Note</dt>
<dd class='body--doc'><p>keys objects may be generated from a decoded key string using
  <a class='ms reference' href='../../8.0_3A_3A/Standards/PKCS/RSA/parse_private_key.html'>Standards.PKCS.RSA.parse_private_key()</a>.</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>use_cache</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>use_cache</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Non-zero to enable cahing of sessions</p>
</dd></dl>


<hr />
<dl class='group--doc'>
<dt class='head--type'><span class='homogen--type'>Variable</span>
<span class='homogen--name'><b>verify_certificates</b></span>
</dt>
<dd><p><code><code class='datatype'>int</code> SSL.context.<b><span class='variable'>verify_certificates</span></b></code></p></dd>

<dt class='head--doc'>Description</dt>
<dd class='body--doc'><p>Determines whether certificates presented by the peer are verified, or
 just accepted as being valid.</p>
</dd></dl>

          </article>
        </div>
      </div>
    </div>
    <footer>
      <div id="build-date">Extracted from <strong data-id="version"></strong> as of <strong data-id="date"></strong>.</div>
    </footer>
    <script>PikeDoc.current = {"link":"ex/7.8_3A_3A/SSL/context.html","name":"context"};</script>
<script src='../../../ex/7.8_3A_3A/SSL/index.js'></script>
<script src='../../../ex/7.8_3A_3A/SSL/context/load_index.js'></script>
    <script>
      // Tell PikeDoc that next actions are from loaded scripts
      PikeDoc.isInline = false;
    </script>
  </body>
</html>
